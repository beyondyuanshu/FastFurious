var globalThis=this;function __skpm_run(key,context){globalThis.context=context;var exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=42)}([function(e,t){e.exports=require("sketch/dom")},function(e,t){e.exports={JS_BRIDGE:"__skpm_sketchBridge",JS_BRIDGE_RESULT_SUCCESS:"__skpm_sketchBridge_success",JS_BRIDGE_RESULT_ERROR:"__skpm_sketchBridge_error",START_MOVING_WINDOW:"__skpm_startMovingWindow",EXECUTE_JAVASCRIPT:"__skpm_executeJS",EXECUTE_JAVASCRIPT_SUCCESS:"__skpm_executeJS_success_",EXECUTE_JAVASCRIPT_ERROR:"__skpm_executeJS_error_"}},function(e,t){e.exports=require("sketch")},function(e,t){e.exports=require("events")},function(e,t,n){"use strict";(function(t){var n=setTimeout;function i(e){return Boolean(e&&void 0!==e.length)}function r(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(r){return void l(t.promise,r)}s(t.promise,i)}else(1===e._state?s:l)(t.promise,e._value)})):e._deferreds.push(t)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void c(e);if("function"==typeof n)return void d((i=n,r=t,function(){i.apply(r,arguments)}),e)}e._state=1,e._value=t,c(e)}catch(a){l(e,a)}var i,r}function l(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function u(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function d(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,l(t,e))})}catch(i){if(n)return;n=!0,l(t,i)}}o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(r);return a(this,new u(e,t,n)),n},o.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},o.all=function(e){return new o(function(t,n){if(!i(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function a(e,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var s=i.then;if("function"==typeof s)return void s.call(i,function(t){a(e,t)},n)}r[e]=i,0==--o&&t(r)}catch(l){n(l)}}for(var s=0;s<r.length;s++)a(s,r[s])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){if(!i(e))return n(new TypeError("Promise.race accepts an array"));for(var r=0,a=e.length;r<a;r++)o.resolve(e[r]).then(t,n)})},o._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){n(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.exports=o}).call(this,n(11).setImmediate)},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,c=[],u=!1,d=-1;function f(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&p())}function p(){if(!u){var e=s(f);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||u||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){e.exports=require("sketch/settings")},function(e,t){e.exports=require("buffer")},function(e,t,n){var i=n(17),r=n(18);e.exports=function e(t,n,o){var a=r(t,n,o);if("."!==a.file[0]&&"/"!==a.file[0]&&"~"!==a.file[0]){var s=e("/bin/bash",["-l","-c","which "+a.file],{encoding:"utf8"});if(s.err)return s;var l=String(s.stdout).trim();return l.length?e(l,n,o):{err:new Error(String(a.file)+" ENOENT")}}var c=a.options,u=NSPipe.pipe(),d=NSPipe.pipe();try{var f=NSTask.alloc().init();f.setLaunchPath(NSString.stringWithString(a.file).stringByExpandingTildeInPath()),f.arguments=NSArray.arrayWithArray(a.args||[]),a.envPairs&&(f.environment=a.envPairs),c.cwd&&f.setCurrentDirectoryPath(NSString.stringWithString(c.cwd).stringByExpandingTildeInPath()),f.setStandardOutput(u),f.setStandardError(d),f.launch(),f.waitUntilExit();var p,h,m,g=!1,S=!1;return"ignored"===a.stdio[1]?g=!0:1===a.stdio[1]?(p=u.fileHandleForReading().readDataToEndOfFile(),h=i(p,c.encoding||"buffer"),console.log(h)):2===a.stdio[1]&&(p=u.fileHandleForReading().readDataToEndOfFile(),h=i(p,c.encoding||"buffer"),console.error(h)),"ignored"===a.stdio[2]?S=!0:1===a.stdio[2]?(p=d.fileHandleForReading().readDataToEndOfFile(),m=i(p,c.encoding||"buffer"),console.log(m)):2===a.stdio[2]&&(p=d.fileHandleForReading().readDataToEndOfFile(),m=i(p,c.encoding||"buffer"),console.error(m)),{pid:String(f.processIdentifier()),status:Number(f.terminationStatus()),get stdout(){return g?null:h||(p=u.fileHandleForReading().readDataToEndOfFile(),i(p,c.encoding||"buffer"))},get stderr(){return S?null:m?h:(p=d.fileHandleForReading().readDataToEndOfFile(),i(p,c.encoding||"buffer"))}}}catch(v){return{err:v}}}},function(e,t,n){(function(t){e.exports.getURL=function(e){return NSURL.URLWithString(String(NSString.stringWithString(e).stringByExpandingTildeInPath()).replace(/ /g,"%20"))},e.exports.runDialog=function(e,n,i){if(!i){var r=e.runModal();return t.resolve(n(e,r))}var o=coscript.createFiber(),a=(i.sketchObject||i).documentWindow();return new t(function(t,i){e.beginSheetModalForWindow_completionHandler(a,__mocha__.createBlock_function("v16@?0q8",function(r){try{t(n(e,r))}catch(a){i(a)}NSApp.endSheet(e),o?o.cleanup():coscript.shouldKeepAround=!1}))})},e.exports.runDialogSync=function(e,t,n){var i;if(!n)return i=e.runModal(),t(e,i);var r=(n.sketchObject||n).documentWindow();return e.beginSheetModalForWindow_completionHandler(r,__mocha__.createBlock_function("v16@?0q8",function(e){NSApp.stopModalWithCode(e)})),i=NSApp.runModalForWindow(r),NSApp.endSheet(e),t(e,i)}}).call(this,n(4))},function(e,t,n){(function(t){var i=n(1);e.exports=function(n,r){return function o(a,s,l){"function"==typeof s&&(l=s,s=!1);var c=coscript.createFiber();return n.navigationDelegate().state&&0==n.navigationDelegate().state.wasReady?new t(function(e,t){r.once("ready-to-show",function(){o(a,s,l).then(e).catch(t),c.cleanup()})}):new t(function(t,o){var s=Math.random();r.webContents.on(i.EXECUTE_JAVASCRIPT_SUCCESS+s,function(e){try{l&&l(null,e),t(e)}catch(n){o(n)}c.cleanup()}),r.webContents.on(i.EXECUTE_JAVASCRIPT_ERROR+s,function(e){try{l?(l(e),t()):o(e)}catch(n){o(n)}c.cleanup()}),n.evaluateJavaScript_completionHandler(e.exports.wrapScript(a,s),null)})}},e.exports.wrapScript=function(e,t){return"window."+i.EXECUTE_JAVASCRIPT+"("+t+", "+JSON.stringify(e)+")"},e.exports.injectScript=function(e){var t="window."+i.EXECUTE_JAVASCRIPT+' = function(id, script) {  try {    var res = eval(script);    if (res && typeof res.then === "function" && typeof res.catch === "function") {      res.then(function (res2) {        window.postMessage("'+i.EXECUTE_JAVASCRIPT_SUCCESS+'" + id, res2);      })      .catch(function (err) {        window.postMessage("'+i.EXECUTE_JAVASCRIPT_ERROR+'" + id, err);      })    } else {      window.postMessage("'+i.EXECUTE_JAVASCRIPT_SUCCESS+'" + id, res);    }  } catch (err) {    window.postMessage("'+i.EXECUTE_JAVASCRIPT_ERROR+'" + id, err);  }}',n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)}}).call(this,n(4))},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(27),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(12))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(i){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=require("sketch/ui")},function(e,t,n){var i=n(15),r=n(17);function o(e,t){return e.appendData(t),e}e.exports=function(e,t,n,a){var s={encoding:"utf8",timeout:0,maxBuffer:204800,killSignal:"SIGTERM",cwd:void 0,env:void 0,shell:!1};"function"==typeof t?(a=t,t=[],n=s):"object"!=typeof t||Array.isArray(t)?n=Object.assign(s,n):(a=n,n=Object.assign(s,t),t=[]),function(e){if(null!=e&&!(Number.isInteger(e)&&e>=0))throw new Error("ERR_OUT_OF_RANGE options.timeout")}(n.timeout),function(e){if(null!=e&&!("number"==typeof e&&e>=0))throw new Error("ERR_OUT_OF_RANGE options.maxBuffer")}(n.maxBuffer);var l,c=i(e,t,{cwd:n.cwd,env:n.env,gid:n.gid,uid:n.uid,shell:n.shell}),u=n.encoding,d=[],f=[],p=0,h=0,m=!1,g=!1,S=null,v=e;function y(e,n){if(!g&&(g=!0,l&&(clearTimeout(l),l=null),a)){var i=r(NSData.dataWithData(d.reduce(o,NSMutableData.data())),u),s=r(NSData.dataWithData(f.reduce(o,NSMutableData.data())),u);S||0!==e||null!==n?(0!==t.length&&(v+=" "+t.join(" ")),S||((S=new Error("Command failed: "+v+"\n"+s)).killed=c.killed||m,S.code=e,S.signal=n),S.cmd=v,a(S,i,s)):a(null,i,s)}}function w(){m=!0;try{c.kill(n.killSignal)}catch(e){S=e,y()}}return n.timeout>0&&(l=setTimeout(function(){w(),l=null},n.timeout)),c.stdout&&(c.stdout.setEncoding("NSData"),c.stdout.on("data",function(e){(p+=e.length())>n.maxBuffer?(S=new Error("ERR_CHILD_PROCESS_STDIO_MAXBUFFER stdout"),w()):d.push(e)})),c.stderr&&(c.stderr.setEncoding("NSData"),c.stderr.on("data",function(e){(h+=e.length())>n.maxBuffer?(S=new Error("ERR_CHILD_PROCESS_STDIO_MAXBUFFER stderr"),w()):f.push(e)})),c.addListener("close",y),c.addListener("error",function(e){S=e,y()}),c}},function(e,t,n){(function(t,i){var r=n(7).Buffer,o=n(3),a=n(16).Readable,s=n(16).Writable,l=n(8),c=n(18);e.exports=function e(n,u,d){var f=c(n,u,d),p=new o;if("."!==f.file[0]&&"/"!==f.file[0]&&"~"!==f.file[0]){var h=l("/bin/bash",["-l","-c","which "+f.file],{encoding:"utf8"}),m=String(h.stdout||"").trim();return h.err||!m.length?(p.stderr=new o,p.stdout=new o,p.pid="-1",p.stderr.setEncoding=function(e){p.stderr.encoding=e},p.stdout.setEncoding=function(e){p.stdout.encoding=e},m.length?p.emit("error",h.err):p.emit("error",new Error(String(f.file)+" ENOENT")),p):e(m,u,d)}var g=f.options;p.killed=!1;var S,v=coscript.createFiber(),y=null,w=!1,b=!1;p.stderr=new a({read:function(){w=!0}}),p.stdout=new a({read:function(){b=!0}}),p.sdtin=new s({write:function(e,t,n){S.standardInput().fileHandleForWriting().writeData(e.toNSData()),n()},final:function(e){S.standardInput().fileHandleForWriting().closeFile(),e()}}),p.sdtio=[p.sdtin,p.sdtout,p.sdterr];try{S=NSTask.alloc().init();var x=NSPipe.pipe(),N=NSPipe.pipe(),_=NSPipe.pipe();S.setStandardInput(x),S.setStandardOutput(N),S.setStandardError(_),S.standardOutput().fileHandleForReading().setReadabilityHandler(__mocha__.createBlock_function('v16@?0@"NSFileHandle"8',function(e){try{(n=e.availableData())&&n.length()&&b&&(p.stdout.push(r.from(n))||(b=!1,S.standardOutput().fileHandleForReading().setReadabilityHandler(null)))}catch(i){void 0!==t&&t.listenerCount&&t.listenerCount("uncaughtException")?t.emit("uncaughtException",i,"uncaughtException"):console.error(i)}var n})),S.standardError().fileHandleForReading().setReadabilityHandler(__mocha__.createBlock_function('v16@?0@"NSFileHandle"8',function(e){try{(n=e.availableData())&&n.length()&&w&&(p.stderr.push(r.from(n))||(w=!1,S.standardError().fileHandleForReading().setReadabilityHandler(null)))}catch(i){void 0!==t&&t.listenerCount&&t.listenerCount("uncaughtException")?t.emit("uncaughtException",i,"uncaughtException"):console.error(i)}var n})),S.setLaunchPath(NSString.stringWithString(f.file).stringByExpandingTildeInPath()),S.arguments=NSArray.arrayWithArray(f.args||[]),f.envPairs&&(S.environment=f.envPairs),g.cwd&&S.setCurrentDirectoryPath(NSString.stringWithString(g.cwd).stringByExpandingTildeInPath()),S.setTerminationHandler(__mocha__.createBlock_function('v16@?0@"NSTask"8',function(e){try{e.standardError().fileHandleForReading().setReadabilityHandler(null),e.standardOutput().fileHandleForReading().setReadabilityHandler(null),p.stderr.emit("close"),p.stdout.emit("close"),p.killed=!0,p.emit("close",Number(e.terminationStatus()),y)}catch(n){void 0!==t&&t.listenerCount&&t.listenerCount("uncaughtException")?t.emit("uncaughtException",n,"uncaughtException"):console.error(n)}v.cleanup()})),i(()=>S.launch())}catch(F){return v.cleanup(),p.emit("error",F),p}return p.kill=function(e){p.killed||(y=e,S.terminate())},p.pid=String(S.processIdentifier()),p}}).call(this,n(5),n(11).setImmediate)},function(e,t){e.exports=require("stream")},function(e,t,n){var i=n(7).Buffer;e.exports=function(e,t){return function(e,t){return"buffer"===t?e:"NSData"===t?e.toNSData():e.toString(t)}(i.from(e),t)}},function(e,t){e.exports=function(e,t,n){if("string"!=typeof e||0===e.length)throw new Error("ERR_INVALID_ARG_TYPE");if(Array.isArray(t))t=t.slice(0);else{if(void 0!==t&&(null===t||"object"!=typeof t))throw new Error("ERR_INVALID_ARG_TYPE args");n=t,t=[]}if(void 0===n)n={};else if(null===n||"object"!=typeof n)throw new Error("ERR_INVALID_ARG_TYPE options");if(null!=n.cwd&&"string"!=typeof n.cwd)throw new Error("ERR_INVALID_ARG_TYPE options.cwd");if(null!=n.detached&&"boolean"!=typeof n.detached)throw new Error("ERR_INVALID_ARG_TYPE options.detached");if(null!=n.uid&&!Number.isInteger(n.uid))throw new Error("ERR_INVALID_ARG_TYPE options.uid");if(null!=n.gid&&!Number.isInteger(n.gid))throw new Error("ERR_INVALID_ARG_TYPE options.gid");if(null!=n.shell&&"boolean"!=typeof n.shell&&"string"!=typeof n.shell)throw new Error("ERR_INVALID_ARG_TYPE options.shell");if(null!=n.argv0&&"string"!=typeof n.argv0)throw new Error("ERR_INVALID_ARG_TYPE options.argv0");if((n=Object.assign({},n)).shell){var i=[e].concat(t).join(" ");e="string"==typeof n.shell?n.shell:"/bin/bash",t=["-l","-c",i]}"string"==typeof n.argv0&&t.unshift(n.argv0);var r=["pipe","pipe","pipe"];return"string"==typeof n.stdio?r="inherit"===n.stdio?[0,1,2]:[n.stdio,n.stdio,n.stdio]:Array.isArray(n.stdio)&&((n.stdio[0]||0===n.stdio[0])&&("inherit"===n.stdio[0]?r[0]=0:r[0]=n.stdio[0]),(n.stdio[1]||0===n.stdio[1])&&("inherit"===n.stdio[1]?r[1]=1:r[1]=n.stdio[1]),(n.stdio[2]||0===n.stdio[2])&&("inherit"===n.stdio[2]?r[2]=2:r[2]=n.stdio[2])),{file:e,args:t,options:n,envPairs:n.env,stdio:r}}},function(e,t,n){var i=n(8);e.exports=function(e,t,n){var r={encoding:"buffer",timeout:0,maxBuffer:204800,killSignal:"SIGTERM",cwd:null,env:null,shell:!1};"object"!=typeof t||Array.isArray(t)?n=Object.assign(r,n||{}):(n=Object.assign(r,t),t=[]),function(e){if(null!=e&&!(Number.isInteger(e)&&e>=0))throw new Error("ERR_OUT_OF_RANGE options.timeout")}(n.timeout),function(e){if(null!=e&&!("number"==typeof e&&e>=0))throw new Error("ERR_OUT_OF_RANGE options.maxBuffer")}(n.maxBuffer);var o=i(e,t,{cwd:n.cwd,env:n.env,gid:n.gid,uid:n.uid,shell:n.shell,encoding:n.encoding,stdio:["pipe","pipe","inherit"]});if(0!==o.status){var a=new Error("Failed to run: "+String(o.stderr));throw a.pid=o.pid,a.status=o.status,a.stdout=o.stdout,a.stderr=o.stderr,a}return o.stdout}},function(e,t,n){var i=n(9);function r(e,t){e&&("function"==typeof e.isKindOfClass||e.sketchObject)||(t=e,e=void 0),t||(t={});var n=NSOpenPanel.openPanel();if(t.title&&(n.title=t.title),t.defaultPath&&n.setDirectoryURL(i.getURL(t.defaultPath)),t.buttonLabel&&(n.prompt=t.buttonLabel),t.filters&&t.filters.length){var r=[];t.filters.forEach(function(e){e.extensions.forEach(function(e){r.push(e)})}),n.allowedFileTypes=r}var o=Array.isArray(t.properties)&&t.properties.length>0;return n.canChooseFiles=o&&-1!==t.properties.indexOf("openFile"),n.canChooseDirectories=o&&-1!==t.properties.indexOf("openDirectory"),n.allowsMultipleSelection=o&&-1!==t.properties.indexOf("multiSelections"),n.showsHiddenFiles=o&&-1!==t.properties.indexOf("showHiddenFiles"),n.canCreateDirectories=o&&-1!==t.properties.indexOf("createDirectory"),n.resolvesAliases=!o||-1===t.properties.indexOf("noResolveAliases"),n.treatsFilePackagesAsDirectories=o&&-1!==t.properties.indexOf("treatPackageAsDirectory"),t.message&&(n.message=t.message),{document:e,options:t,dialog:n}}e.exports.openDialog=function(e,t){var n=r(e,t);return i.runDialog(n.dialog,function(e,t){if(t!=NSOKButton)return{canceled:!0,filePaths:[]};for(var n=[],i=e.URLs(),r=0;r<i.length;r+=1)n.push(String(i[r].path()));return{canceled:!1,filePaths:n}},n.document)},e.exports.openDialogSync=function(e,t){var n=r(e,t);return i.runDialogSync(n.dialog,function(e,t){if(t!=NSOKButton)return[];for(var n=[],i=e.URLs(),r=0;r<i.length;r+=1)n.push(String(i[r].path()));return n},n.document)}},function(e,t,n){var i=n(9);function r(e,t){e&&("function"==typeof e.isKindOfClass||e.sketchObject)||(t=e,e=void 0),t||(t={});var n=NSSavePanel.savePanel();if(t.title&&(n.title=t.title),t.defaultPath)if(n.setDirectoryURL(i.getURL(t.defaultPath)),"."===t.defaultPath[0]||"~"===t.defaultPath[0]||"/"===t.defaultPath[0]){var r=t.defaultPath.split("/");r.length>1&&r[r.length-1]&&n.setNameFieldStringValue(r[r.length-1])}else n.setNameFieldStringValue(t.defaultPath);if(t.buttonLabel&&(n.prompt=t.buttonLabel),t.filters&&t.filters.length){var o=[];t.filters.forEach(function(e){e.extensions.forEach(function(e){o.push(e)})}),n.allowedFileTypes=o}return t.message&&(n.message=t.message),t.nameFieldLabel&&(n.nameFieldLabel=t.nameFieldLabel),t.showsTagField&&(n.showsTagField=t.showsTagField),{document:e,options:t,dialog:n}}e.exports.saveDialog=function(e,t){var n=r(e,t);return i.runDialog(n.dialog,function(e,t){return{canceled:t!=NSOKButton,filePath:t==NSOKButton?String(e.URL().path()):void 0}},n.document)},e.exports.saveDialogSync=function(e,t){var n=r(e,t);return i.runDialogSync(n.dialog,function(e,t){return t==NSOKButton?String(e.URL().path()):void 0},n.document)}},function(e,t,n){var i=n(9),r={none:0,info:1,error:2,question:1,warning:2};function o(e,t){!e||"function"!=typeof e.isKindOfClass&&!e.sketchObject?(t=e,e=void 0):e.sketchObject&&(e=e.sketchObject),t||(t={});var n=NSAlert.alloc().init();if(t.type&&(n.alertStyle=r[t.type]||0),t.buttons&&t.buttons.length&&t.buttons.forEach(function(e){n.addButtonWithTitle(t.normalizeAccessKeys?e.replace(/&/g,""):e)}),void 0!==t.defaultId){var i=n.buttons();t.defaultId<i.length&&(i[0].setKeyEquivalent(""),i[t.defaultId].setKeyEquivalent("\r"))}if(t.title,t.message&&(n.messageText=t.message),t.detail&&(n.informativeText=t.detail),t.checkboxLabel&&(n.showsSuppressionButton=!0,n.suppressionButton().title=t.checkboxLabel,void 0!==t.checkboxChecked&&(n.suppressionButton().state=t.checkboxChecked?NSOnState:NSOffState)),t.icon)"string"==typeof t.icon&&(t.icon=NSImage.alloc().initWithContentsOfFile(t.icon)),n.icon=t.icon;else if("undefined"!=typeof __command&&__command.pluginBundle()&&__command.pluginBundle().icon())n.icon=__command.pluginBundle().icon();else{var o=NSImage.imageNamed("plugins");o&&(n.icon=o)}return{document:e,options:t,dialog:n}}e.exports.messageBox=function(e,t){var n=o(e,t);return i.runDialog(n.dialog,function(e,t){return{response:n.options.buttons&&n.options.buttons.length?Number(t)-1e3:Number(t),checkboxChecked:e.suppressionButton().state()==NSOnState}},n.document)},e.exports.messageBoxSync=function(e,t){var n=o(e,t);return i.runDialogSync(n.dialog,function(e,t){return n.options.buttons&&n.options.buttons.length?Number(t)-1e3:Number(t)},n.document)}},function(e,t,n){var i=n(3),r=n(25),o=n(26),a=n(28),s=n(29),l=n(30),c=n(31),u=n(10),d=n(32);function f(e){var t=(e=e||{}).identifier||NSUUID.UUID().UUIDString(),n=NSThread.mainThread().threadDictionary(),p=f.fromId(t);if(p)return p;var h=new i;if(h.id=t,e.modal&&!e.parent)throw new Error("A modal needs to have a parent.");var m=coscript.createFiber(),g=e.width||800,S=e.height||600,v=NSScreen.screens().firstObject().frame(),y=NSMakeRect(void 0!==e.x?e.x:Math.round((NSWidth(v)-g)/2),void 0!==e.y?NSHeight(v)-e.y:Math.round((NSHeight(v)-S)/2),g,S);e.titleBarStyle&&"default"!==e.titleBarStyle&&(e.frame=!1);var w="textured"!==e.windowType,b=NSTitledWindowMask;!1!==e.minimizable&&(b|=NSMiniaturizableWindowMask),!1!==e.closable&&(b|=NSClosableWindowMask),!1!==e.resizable&&(b|=NSResizableWindowMask),w&&!e.transparent&&!1!==e.frame||(b|=NSTexturedBackgroundWindowMask);var x=NSPanel.alloc().initWithContentRect_styleMask_backing_defer(y,b,NSBackingStoreBuffered,!0),N=WKWebViewConfiguration.alloc().init(),_=WKWebView.alloc().initWithFrame_configuration(CGRectMake(0,0,e.width||800,e.height||600),N);if(l(_),_.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),r(h,x,_),o(h,x,_),d(h,x,_,e),"desktop"===e.windowType&&(x.setLevel(kCGDesktopWindowLevel-1),x.setCollectionBehavior(NSWindowCollectionBehaviorCanJoinAllSpaces|NSWindowCollectionBehaviorStationary|NSWindowCollectionBehaviorIgnoresCycle)),void 0===e.minWidth&&void 0===e.minHeight||h.setMinimumSize(e.minWidth||0,e.minHeight||0),void 0===e.maxWidth&&void 0===e.maxHeight||h.setMaximumSize(e.maxWidth||1e4,e.maxHeight||1e4),e.transparent||!1===e.frame){x.titlebarAppearsTransparent=!0,x.titleVisibility=NSWindowTitleHidden,x.setOpaque(0),x.isMovableByWindowBackground=!0;var F=NSToolbar.alloc().initWithIdentifier("titlebarStylingToolbar");F.setShowsBaselineSeparator(!1),x.setToolbar(F)}if("hiddenInset"===e.titleBarStyle){var E=NSToolbar.alloc().initWithIdentifier("titlebarStylingToolbar");E.setShowsBaselineSeparator(!1),x.setToolbar(E)}!1!==e.frame&&e.useContentSize||h.setSize(g,S),e.center&&h.center(),e.alwaysOnTop&&h.setAlwaysOnTop(!0),e.fullscreen&&h.setFullScreen(!0),h.setFullScreenable(!!e.fullscreenable);let T=e.title;!1===e.frame?T=void 0:void 0===T&&"undefined"!=typeof __command&&__command.pluginBundle()&&(T=__command.pluginBundle().name()),T&&h.setTitle(T);var C=e.backgroundColor;e.transparent&&(C=NSColor.clearColor()),!C&&!1===e.frame&&e.vibrancy&&(C=NSColor.clearColor()),h._setBackgroundColor(C||NSColor.windowBackgroundColor()),!1===e.hasShadow&&h.setHasShadow(!1),void 0!==e.opacity&&h.setOpacity(e.opacity),e.webPreferences=e.webPreferences||{},_.configuration().preferences().setValue_forKey(!1!==e.webPreferences.devTools,"developerExtrasEnabled"),_.configuration().preferences().setValue_forKey(!1!==e.webPreferences.javascript,"javaScriptEnabled"),_.configuration().preferences().setValue_forKey(!!e.webPreferences.plugins,"plugInsEnabled"),_.configuration().preferences().setValue_forKey(e.webPreferences.minimumFontSize||0,"minimumFontSize"),e.webPreferences.zoomFactor&&_.setMagnification(e.webPreferences.zoomFactor);var M=x.contentView();return!1!==e.frame?(_.setFrame(M.bounds()),M.addSubview(_)):(M.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),a(M,M.superview()),_.setFrame(M.bounds()),M.addSubview(_),x.standardWindowButton(NSWindowFullScreenButton)&&x.standardWindowButton(NSWindowFullScreenButton).setHidden(!0),e.titleBarStyle&&"default"!==e.titleBarStyle||(x.standardWindowButton(NSWindowZoomButton).setHidden(!0),x.standardWindowButton(NSWindowMiniaturizeButton).setHidden(!0),x.standardWindowButton(NSWindowCloseButton).setHidden(!0),x.standardWindowButton(NSWindowZoomButton).setEnabled(!1))),e.vibrancy&&h.setVibrancy(e.vibrancy),h.setMaximizable(!1!==e.maximizable),x.setHidesOnDeactivate(!1!==e.hidesOnDeactivate),e.remembersWindowFrame&&(x.setFrameAutosaveName(t),x.setFrameUsingName_force(x.frameAutosaveName(),!1)),e.acceptsFirstMouse&&h.on("focus",function(e){e.type()===NSEventTypeLeftMouseDown&&h.webContents.executeJavaScript(s(_,e)).catch(()=>{})}),u.injectScript(_),c.injectScript(_),c.setupHandler(h),!1!==e.show&&h.show(),h.on("closed",function(){h._destroyed=!0,n.removeObjectForKey(t);var e=n[t+".themeObserver"];e&&(NSApplication.sharedApplication().removeObserver_forKeyPath(e,"effectiveAppearance"),n.removeObjectForKey(t+".themeObserver")),m.cleanup()}),n[t]=x,m.onCleanup(function(){h._destroyed||h.destroy()}),h}f.fromId=function(e){var t=NSThread.mainThread().threadDictionary();if(t[e])return f.fromPanel(t[e],e)},f.fromPanel=function(e,t){var n=new i;if(n.id=t,!e||!e.contentView)throw new Error("needs to pass an NSPanel");for(var a=null,s=e.contentView().subviews(),l=0;l<s.length;l+=1)a||s[l].isKindOfClass(WKInspectorWKWebView)||!s[l].isKindOfClass(WKWebView)||(a=s[l]);if(!a)throw new Error("The panel needs to have a webview");return r(n,e,a),o(n,e,a),n},e.exports=f},function(e,t,n){e.exports={showOpenDialog:n(20).openDialog,showOpenDialogSync:n(20).openDialogSync,showSaveDialog:n(21).saveDialog,showSaveDialogSync:n(21).saveDialogSync,showMessageBox:n(22).messageBox,showMessageBoxSync:n(22).messageBoxSync}},function(e,t){e.exports=function(e,t,n){function i(n){e.isVisible()&&(n?(NSApplication.sharedApplication().activateIgnoringOtherApps(!0),t.makeKeyAndOrderFront(null)):(t.orderBack(null),NSApp.mainWindow().makeKeyAndOrderFront(null)))}e._panel=t,e._webview=n,e._destroyed=!1,e.destroy=function(){return t.close()},e.close=function(){if(t.delegate().utils&&t.delegate().utils.parentWindow){var n=!0;return e.emit("close",{get defaultPrevented(){return!n},preventDefault:function(){n=!1}}),void(n&&t.delegate().utils.parentWindow.endSheet(t))}e.isClosable()&&t.performClose(null)},e.focus=i.bind(this,!0),e.blur=i.bind(this,!1),e.isFocused=function(){return t.isKeyWindow()},e.isDestroyed=function(){return e._destroyed},e.show=function(){return NSApp.activateIgnoringOtherApps(!0),t.delegate().utils&&t.delegate().utils.parentWindow?t.delegate().utils.parentWindow.beginSheet_completionHandler(t,__mocha__.createBlock_function("v16@?0q8",function(){e.emit("closed")})):t.makeKeyAndOrderFront(null)},e.showInactive=function(){return t.orderFrontRegardless()},e.hide=function(){return t.orderOut(null)},e.isVisible=function(){return t.isVisible()},e.isModal=function(){return!1},e.maximize=function(){e.isMaximized()||t.zoom(null)},e.unmaximize=function(){e.isMaximized()&&t.zoom(null)},e.isMaximized=function(){if(0!=(t.styleMask()&NSResizableWindowMask))return t.isZoomed();var e=NSScreen.mainScreen().visibleFrame(),n=t.frame();return e.origin.x==n.origin.x&&e.origin.y==n.origin.y&&e.size.width==n.size.width&&e.size.height==n.size.height},e.minimize=function(){return t.miniaturize(null)},e.restore=function(){return t.deminiaturize(null)},e.isMinimized=function(){return t.isMiniaturized()},e.setFullScreen=function(n){n!==e.isFullscreen()&&t.toggleFullScreen(null)},e.isFullscreen=function(){return t.styleMask()&NSFullScreenWindowMask},e.setAspectRatio=function(e){e>0?t.setAspectRatio(NSMakeSize(e,1)):t.setResizeIncrements(NSMakeSize(1,1))},e.setBounds=function(n,i){if(!n)return;if(e.isFullscreen())return;const r=Object.assign(e.getBounds(),n);var o=NSMakeRect(r.x,0,r.width,r.height),a=NSScreen.screens().firstObject();o.origin.y=NSHeight(a.frame())-r.y,t.setFrame_display_animate(o,!0,i)},e.getBounds=function(){const e=t.frame();var n=NSScreen.screens().firstObject().frame();return{x:e.origin.x,y:Math.round(NSHeight(n)-e.origin.y),width:e.size.width,height:e.size.height}},e.setContentBounds=function(t,n){e.setBounds(t,n)},e.getContentBounds=function(){return e.getBounds()},e.setSize=function(t,n,i){return e.setBounds({width:t,height:n},i)},e.getSize=function(){var t=e.getBounds();return[t.width,t.height]},e.setContentSize=function(t,n,i){return e.setContentBounds({width:t,height:n},i)},e.getContentSize=function(){var t=e.getContentBounds();return[t.width,t.height]},e.setMinimumSize=function(e,n){const i=CGSizeMake(e,n);t.setContentMinSize(i)},e.getMinimumSize=function(){const e=t.contentMinSize();return[e.width,e.height]},e.setMaximumSize=function(e,n){const i=CGSizeMake(e,n);t.setContentMaxSize(i)},e.getMaximumSize=function(){const e=t.contentMaxSize();return[e.width,e.height]},e.setResizable=function(t){return e._setStyleMask(t,NSResizableWindowMask)},e.isResizable=function(){return t.styleMask()&NSResizableWindowMask},e.setMovable=function(e){return t.setMovable(e)},e.isMovable=function(){return t.isMovable()},e.setMinimizable=function(t){return e._setStyleMask(t,NSMiniaturizableWindowMask)},e.isMinimizable=function(){return t.styleMask()&NSMiniaturizableWindowMask},e.setMaximizable=function(e){t.standardWindowButton(NSWindowZoomButton)&&t.standardWindowButton(NSWindowZoomButton).setEnabled(e)},e.isMaximizable=function(){return t.standardWindowButton(NSWindowZoomButton)&&t.standardWindowButton(NSWindowZoomButton).isEnabled()},e.setFullScreenable=function(t){e._setCollectionBehavior(t,NSWindowCollectionBehaviorFullScreenPrimary),e._setCollectionBehavior(!t,NSWindowCollectionBehaviorFullScreenAuxiliary)},e.isFullScreenable=function(){return t.collectionBehavior()&NSWindowCollectionBehaviorFullScreenPrimary},e.setClosable=function(t){e._setStyleMask(t,NSClosableWindowMask)},e.isClosable=function(){return t.styleMask()&NSClosableWindowMask},e.setAlwaysOnTop=function(e,n,i){var r=NSNormalWindowLevel,o=CGWindowLevelForKey(kCGMaximumWindowLevelKey),a=CGWindowLevelForKey(kCGMinimumWindowLevelKey);e&&(r="normal"===n?NSNormalWindowLevel:"torn-off-menu"===n?NSTornOffMenuWindowLevel:"modal-panel"===n?NSModalPanelWindowLevel:"main-menu"===n?NSMainMenuWindowLevel:"status"===n?NSStatusWindowLevel:"pop-up-menu"===n?NSPopUpMenuWindowLevel:"screen-saver"===n?NSScreenSaverWindowLevel:"dock"===n?NSDockWindowLevel:NSFloatingWindowLevel);var s=r+(i||0);if(!(s>=a&&s<=o))throw new Error("relativeLevel must be between "+a+" and "+o);t.setLevel(s)},e.isAlwaysOnTop=function(){return t.level()!==NSNormalWindowLevel},e.moveTop=function(){return t.orderFrontRegardless()},e.center=function(){t.center()},e.setPosition=function(t,n,i){return e.setBounds({x:t,y:n},i)},e.getPosition=function(){var t=e.getBounds();return[t.x,t.y]},e.setTitle=function(e){t.setTitle(e)},e.getTitle=function(){return String(t.title())};var r=0;e.flashFrame=function(e){e?r=NSApp.requestUserAttention(NSInformationalRequest):(NSApp.cancelUserAttentionRequest(r),r=0)},e.getNativeWindowHandle=function(){return t},e.getNativeWebViewHandle=function(){return n},e.loadURL=function(e){if(/^(?!https?|file).*\.html?$/.test(e)&&"undefined"!=typeof __command&&__command.pluginBundle()&&(e="file://"+__command.pluginBundle().urlForResourceNamed(e).path()),/^file:\/\/.*\.html?$/.test(e))return e=(e=NSString.alloc().initWithString(e)).stringByAddingPercentEncodingWithAllowedCharacters(NSCharacterSet.URLQueryAllowedCharacterSet()),void n.loadFileURL_allowingReadAccessToURL(NSURL.URLWithString(e),NSURL.URLWithString("file:///"));const t=NSURL.URLWithString(e),i=NSURLRequest.requestWithURL(t);n.loadRequest(i)},e.reload=function(){n.reload()},e.setHasShadow=function(e){return t.setHasShadow(e)},e.hasShadow=function(){return t.hasShadow()},e.setOpacity=function(e){return t.setAlphaValue(e)},e.getOpacity=function(){return t.alphaValue()},e.setVisibleOnAllWorkspaces=function(t){return e._setCollectionBehavior(t,NSWindowCollectionBehaviorCanJoinAllSpaces)},e.isVisibleOnAllWorkspaces=function(){return t.collectionBehavior()&NSWindowCollectionBehaviorCanJoinAllSpaces},e.setIgnoreMouseEvents=function(e){return t.setIgnoresMouseEvents(e)},e.setContentProtection=function(e){t.setSharingType(e?NSWindowSharingNone:NSWindowSharingReadOnly)},e.setAutoHideCursor=function(e){t.setDisableAutoHideCursor(e)},e.setVibrancy=function(n){var i=e._vibrantView;if(!n){if(null==i)return;return i.removeFromSuperview(),void t.setVibrantView(null)}if(null==i){var r=t.contentView();i=NSVisualEffectView.alloc().initWithFrame(r.bounds()),e._vibrantView=i,i.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),i.setBlendingMode(NSVisualEffectBlendingModeBehindWindow),i.setState(NSVisualEffectStateActive),i.setFrame(r.bounds()),r.addSubview_positioned_relativeTo(i,NSWindowBelow,null)}var o=NSVisualEffectMaterialLight;"appearance-based"===n?o=NSVisualEffectMaterialAppearanceBased:"light"===n?o=NSVisualEffectMaterialLight:"dark"===n?o=NSVisualEffectMaterialDark:"titlebar"===n?o=NSVisualEffectMaterialTitlebar:"selection"===n?o=NSVisualEffectMaterialSelection:"menu"===n?o=NSVisualEffectMaterialMenu:"popover"===n?o=NSVisualEffectMaterialPopover:"sidebar"===n?o=NSVisualEffectMaterialSidebar:"medium-light"===n?o=NSVisualEffectMaterialMediumLight:"ultra-dark"===n&&(o=NSVisualEffectMaterialUltraDark),i.setMaterial(o)},e._setBackgroundColor=function(e){var i=function(e){if(!e||"#"!==e[0]){if(e&&"function"==typeof e.isKindOfClass&&e.isKindOfClass(NSColor))return e;throw new Error("Incorrect color formating. It should be an hex color: #RRGGBBAA")}var t,n=e.substr(1);if(3===n.length?n+="F":6===n.length&&(n+="FF"),4===n.length)for(var i=0;i<4;i+=1)t+=n[i],t+=n[i];else{if(8!==n.length)return NSColor.whiteColor();t=n}var r=parseInt(t.slice(0,2),16),o=parseInt(t.slice(2,4),16),a=parseInt(t.slice(4,6),16),s=parseInt(t.slice(6,8),16);return NSColor.colorWithSRGBRed_green_blue_alpha(r,o,a,s)}(e);n.setValue_forKey(!1,"drawsBackground"),t.backgroundColor=i},e._invalidate=function(){t.flushWindow(),t.contentView().setNeedsDisplay(!0)},e._setStyleMask=function(n,i){var r=e.isMaximizable();n?t.setStyleMask(t.styleMask()|i):t.setStyleMask(t.styleMask()&~i),e.setMaximizable(r)},e._setCollectionBehavior=function(n,i){var r=e.isMaximizable();n?t.setCollectionBehavior(t.collectionBehavior()|i):t.setCollectionBehavior(t.collectionBehavior()&~i),e.setMaximizable(r)},e._showWindowButton=function(e){var n=t.standardWindowButton(e);n.superview().addSubview_positioned_relative(n,NSWindowAbove,null)}}},function(e,t,n){var i=n(3),r=n(10);e.exports=function(e,t,n){var o=new i;o.loadURL=e.loadURL,o.loadFile=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.downloadURL=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.getURL=function(){return String(n.url())},o.getTitle=function(){return String(n.title())},o.isDestroyed=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.focus=e.focus,o.isFocused=e.isFocused,o.isLoading=function(){return!!n.loading()},o.isLoadingMainFrame=function(){return!!n.loading()},o.isWaitingForResponse=function(){return!n.loading()},o.stop=function(){n.stopLoading()},o.reload=function(){n.reload()},o.reloadIgnoringCache=function(){n.reloadFromOrigin()},o.canGoBack=function(){return!!n.canGoBack()},o.canGoForward=function(){return!!n.canGoForward()},o.canGoToOffset=function(e){return!!n.backForwardList().itemAtIndex(e)},o.clearHistory=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.goBack=function(){n.goBack()},o.goForward=function(){n.goForward()},o.goToIndex=function(e){var t=n.backForwardList(),i=t.backList(),r=i.count();if(r>e)n.loadRequest(NSURLRequest.requestWithURL(i[e]));else{var o=t.forwardList();if(!(o.count()>e-r))throw new Error("Cannot go to index "+e);n.loadRequest(NSURLRequest.requestWithURL(o[e-r]))}},o.goToOffset=function(e){if(!o.canGoToOffset(e))throw new Error("Cannot go to offset "+e);n.loadRequest(NSURLRequest.requestWithURL(n.backForwardList().itemAtIndex(e)))},o.isCrashed=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setUserAgent=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.getUserAgent=function(){const e=n.customUserAgent();return e?String(e):void 0},o.insertCSS=function(e){var t="var style = document.createElement('style'); style.innerHTML = "+e.replace(/"/,'\\"')+"; document.head.appendChild(style);",i=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);n.configuration().userContentController().addUserScript(i)},o.insertJS=function(e){var t=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(e,0,!0);n.configuration().userContentController().addUserScript(t)},o.executeJavaScript=r(n,e),o.setIgnoreMenuShortcuts=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setAudioMuted=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.isAudioMuted=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setZoomFactor=function(e){n.setMagnification_centeredAtPoint(e,CGPointMake(0,0))},o.getZoomFactor=function(e){e(Number(n.magnification()))},o.setZoomLevel=function(e){o.setZoomFactor(Math.pow(1.2,e))},o.getZoomLevel=function(e){e(Math.log(Number(n.magnification()))/Math.log(1.2))},o.setVisualZoomLevelLimits=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setLayoutZoomLevelLimits=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.send=function(){const e="window.postMessage({isSketchMessage: true,origin: '"+String(__command.identifier())+"',args: "+JSON.stringify([].slice.call(arguments))+'}, "*")';n.evaluateJavaScript_completionHandler(e,null)},o.getNativeWebview=function(){return n},e.webContents=o}},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,o,a,s,l=1,c={},u=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){h(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){h(e.data)},i=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(r=d.documentElement,i=function(e){var t=d.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(h,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&h(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return c[l]=r,i(l),l++},f.clearImmediate=p}function p(e){delete c[e]}function h(e){if(u)setTimeout(h,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}(t)}finally{p(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(12),n(5))},function(e,t){function n(e,t,n,i){n.addConstraint(NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(t,e,NSLayoutRelationEqual,n,e,1,i))}e.exports=function(e,t,i){i=i||[],e.setTranslatesAutoresizingMaskIntoConstraints(!1),n(NSLayoutAttributeLeft,e,t,i[0]||0),n(NSLayoutAttributeTop,e,t,i[1]||0),n(NSLayoutAttributeRight,e,t,i[2]||0),n(NSLayoutAttributeBottom,e,t,i[3]||0)}},function(e,t){e.exports=function(e,t){var n=e.convertPoint_fromView(t.locationInWindow(),null);return"var el = document.elementFromPoint("+n.x+", "+n.y+'); if (el && el.tagName === "SELECT") {  var event = document.createEvent("MouseEvents");  event.initMouseEvent("mousedown", true, true, window);  el.dispatchEvent(event);} else if (el && ["text", "textarea", "date", "datetime-local", "email", "number", "month", "password", "search", "tel", "time", "url", "week" ].indexOf(el.type) >= 0 && el.focus) {el.focus();} else if (el) {el.dispatchEvent(new Event("click", {bubbles: true}))}'}},function(e,t,n){var i=n(1);e.exports=function(e){var t='window.originalPostMessage = window.postMessage;window.postMessage = function(actionName) {  if (!actionName) {    throw new Error(\'missing action name\')  }  var id = String(Math.random()).replace(".", "");    var args = [].slice.call(arguments);    args.unshift(id);  return new Promise(function (resolve, reject) {    window["'+i.JS_BRIDGE_RESULT_SUCCESS+'" + id] = resolve;    window["'+i.JS_BRIDGE_RESULT_ERROR+'" + id] = reject;    window.webkit.messageHandlers.'+i.JS_BRIDGE+".postMessage(JSON.stringify(args));  });}",n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)}},function(e,t,n){var i=n(1);e.exports.injectScript=function(e){var t='(function () {document.addEventListener(\'mousedown\', onMouseDown);function shouldDrag(target) {  if (!target || (target.dataset || {}).appRegion === "no-drag") { return false }  if ((target.dataset || {}).appRegion === "drag") { return true }  return shouldDrag(target.parentElement)};function onMouseDown(e) {  if (e.button !== 0 || !shouldDrag(e.target)) { return }  window.postMessage("'+i.START_MOVING_WINDOW+'");};})()',n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)},e.exports.setupHandler=function(e){var t=null,n=null,r=null;function o(){if(!n||1!==NSEvent.pressedMouseButtons())return clearInterval(r),t=null,void(n=null);var i=NSEvent.mouseLocation();e.setPosition(n.x+(i.x-t.x),n.y+(t.y-i.y),!1)}e.webContents.on(i.START_MOVING_WINDOW,function(){t=NSEvent.mouseLocation();var i=e.getPosition();n={x:i[0],y:i[1]},r=setInterval(o,1e3/60)})}},function(e,t,n){(function(t,i){var r,o,a,s,l=n(33),c=n(34),u=n(1);e.exports=function(e,n,d,f){s||(s=new l({utils:null,"observeValueForKeyPath:ofObject:change:context:":function(){this.utils.executeJavaScript("document.body.classList.remove('__skpm-"+("undefined"!=typeof MSTheme&&MSTheme.sharedTheme().isDark()?"light":"dark")+"'); document.body.classList.add('__skpm-"+("undefined"!=typeof MSTheme&&MSTheme.sharedTheme().isDark()?"dark":"light")+"')")}})),r||(r=new l({utils:null,panel:null,"windowDidResize:":function(){this.utils.emit("resize")},"windowDidMiniaturize:":function(){this.utils.emit("minimize")},"windowDidDeminiaturize:":function(){this.utils.emit("restore")},"windowDidEnterFullScreen:":function(){this.utils.emit("enter-full-screen")},"windowDidExitFullScreen:":function(){this.utils.emit("leave-full-screen")},"windowDidMove:":function(){this.utils.emit("move"),this.utils.emit("moved")},"windowShouldClose:":function(){var e=1;return this.utils.emit("close",{get defaultPrevented(){return!e},preventDefault:function(){e=0}}),e},"windowWillClose:":function(){this.utils.emit("closed")},"windowDidBecomeKey:":function(){this.utils.emit("focus",this.panel.currentEvent())},"windowDidResignKey:":function(){this.utils.emit("blur")}})),o||(o=new l({state:{wasReady:0},utils:null,"webView:didCommitNavigation:":function(e){this.utils.emit("will-navigate",{},String(String(e.URL())))},"webView:didStartProvisionalNavigation:":function(){this.utils.emit("did-start-navigation"),this.utils.emit("did-start-loading")},"webView:didReceiveServerRedirectForProvisionalNavigation:":function(){this.utils.emit("did-get-redirect-request")},"webView:didFailProvisionalNavigation:withError:":function(e,t,n){this.utils.emit("did-fail-load",n)},"webView:didFinishNavigation:":function(){0==this.state.wasReady&&(this.state.wasReady=1,this.utils.emitBrowserEvent("ready-to-show")),this.utils.emit("did-navigate"),this.utils.emit("did-frame-navigate"),this.utils.emit("did-stop-loading"),this.utils.emit("did-finish-load"),this.utils.emit("did-frame-finish-load")},"webViewWebContentProcessDidTerminate:":function(){this.utils.emit("dom-ready")}})),a||(a=new l({utils:null,"userContentController:didReceiveScriptMessage:":function(e,t){var n=this.utils.parseWebArguments(String(t.body()));n&&n[0]&&"string"==typeof n[0]&&(n[0]=String(n[0]),this.utils.emit.apply(this,n))}}));var p=s.new({utils:{executeJavaScript(e){d.evaluateJavaScript_completionHandler(e,null)}}}),h=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly("document.addEventListener('DOMContentLoaded', function() { document.body.classList.add('__skpm-"+("undefined"!=typeof MSTheme&&MSTheme.sharedTheme().isDark()?"dark":"light")+"') }, false)",0,!0);d.configuration().userContentController().addUserScript(h),NSApplication.sharedApplication().addObserver_forKeyPath_options_context(p,"effectiveAppearance",NSKeyValueChangeNewKey,null),NSThread.mainThread().threadDictionary()[e.id+".themeObserver"]=p;var m=o.new({utils:{setTitle:e.setTitle.bind(e),emitBrowserEvent(){try{e.emit.apply(e,arguments)}catch(n){if(void 0===t||!t.listenerCount||!t.listenerCount("uncaughtException"))throw console.error(n),n;t.emit("uncaughtException",n,"uncaughtException")}},emit(){try{e.webContents.emit.apply(e.webContents,arguments)}catch(n){if(void 0===t||!t.listenerCount||!t.listenerCount("uncaughtException"))throw console.error(n),n;t.emit("uncaughtException",n,"uncaughtException")}}},state:{wasReady:0}});d.setNavigationDelegate(m);var g=a.new({utils:{emit(t,n){if(n){for(var r=[],o=2;o<arguments.length;o+=1)r.push(arguments[o]);var a=e.webContents.listeners(n);i.all(a.map(function(e){return i.resolve().then(function(){return e.apply(e,r)})})).then(function(e){d.evaluateJavaScript_completionHandler(u.JS_BRIDGE_RESULT_SUCCESS+t+"("+JSON.stringify(e)+")",null)}).catch(function(e){d.evaluateJavaScript_completionHandler(u.JS_BRIDGE_RESULT_ERROR+t+"("+JSON.stringify(e)+")",null)})}else d.evaluateJavaScript_completionHandler(u.JS_BRIDGE_RESULT_SUCCESS+t+"()",null)},parseWebArguments:c}});d.configuration().userContentController().addScriptMessageHandler_name(g,u.JS_BRIDGE);var S,v={emit(){try{e.emit.apply(e,arguments)}catch(n){if(void 0===t||!t.listenerCount||!t.listenerCount("uncaughtException"))throw console.error(n),n;t.emit("uncaughtException",n,"uncaughtException")}}};f.modal&&((S="Document"===f.parent.type?f.parent.sketchObject:f.parent)&&"MSDocumentData"===String(S.class())&&(S=S.delegate()),v.parentWindow=S.windowForSheet());var y=r.new({utils:v,panel:n});n.setDelegate(y)}}).call(this,n(5),n(4))},function(module,exports){module.exports=function MochaDelegate(definition,superclass){var uniqueClassName="MochaJSDelegate_DynamicClass_"+NSUUID.UUID().UUIDString(),delegateClassDesc=MOClassDescription.allocateDescriptionForClassWithName_superclass_(uniqueClassName,superclass||NSObject),handlers={},ivars={};function setHandlerForSelector(selectorString,func){var handlerHasBeenSet=selectorString in handlers,selector=NSSelectorFromString(selectorString);if(handlers[selectorString]=func,!handlerHasBeenSet){for(var args=[],regex=/:/g;regex.exec(selectorString);)args.push("arg"+args.length);var dynamicFunction=eval("(function ("+args.join(", ")+") { return handlers[selectorString].apply(this, arguments); })");delegateClassDesc.addInstanceMethodWithSelector_function(selector,dynamicFunction)}}function setIvar(e,t){var n=e in handlers;if(ivars[e]=t,!n){delegateClassDesc.addInstanceVariableWithName_typeEncoding(e,"@");var i=MOPropertyDescription.new();i.name=e,i.typeEncoding="@",i.weak=!0,i.ivarName=e,delegateClassDesc.addProperty(i)}}this.getClass=function(){return NSClassFromString(uniqueClassName)},this.getClassInstance=function(e){var t=NSClassFromString(uniqueClassName).new();return Object.keys(ivars).forEach(function(e){t[e]=ivars[e]}),Object.keys(e||{}).forEach(function(n){t[n]=e[n]}),t},this.new=this.getClassInstance,"object"==typeof definition&&Object.keys(definition).forEach(function(e){"function"==typeof definition[e]?setHandlerForSelector(e,definition[e]):setIvar(e,definition[e])}),delegateClassDesc.registerClass()}},function(e,t){e.exports=function(e){var t=null;try{t=JSON.parse(e)}catch(n){}return t&&t.constructor&&t.constructor===Array&&0!=t.length?t:null}},function(e,t){e.exports=require("os")},function(e,t,n){var i=n(7).Buffer,r=n(37),o=r.parseStat,a=r.fsError,s=r.fsErrorForPath,l=r.encodingFromOptions,c=r.NOT_IMPLEMENTED;e.exports.constants={F_OK:0,R_OK:4,W_OK:2,X_OK:1},e.exports.access=c("access"),e.exports.accessSync=function(t,n){n|=0;var i=NSFileManager.defaultManager();switch(n){case 0:canAccess=e.exports.existsSync(t);break;case 1:canAccess=Boolean(Number(i.isExecutableFileAtPath(t)));break;case 2:canAccess=Boolean(Number(i.isWritableFileAtPath(t)));break;case 3:canAccess=Boolean(Number(i.isExecutableFileAtPath(t)))&&Boolean(Number(i.isWritableFileAtPath(t)));break;case 4:canAccess=Boolean(Number(i.isReadableFileAtPath(t)));break;case 5:canAccess=Boolean(Number(i.isReadableFileAtPath(t)))&&Boolean(Number(i.isExecutableFileAtPath(t)));break;case 6:canAccess=Boolean(Number(i.isReadableFileAtPath(t)))&&Boolean(Number(i.isWritableFileAtPath(t)));break;case 7:canAccess=Boolean(Number(i.isReadableFileAtPath(t)))&&Boolean(Number(i.isWritableFileAtPath(t)))&&Boolean(Number(i.isExecutableFileAtPath(t)))}if(!canAccess)throw new Error("Can't access "+String(t))},e.exports.appendFile=c("appendFile"),e.exports.appendFileSync=function(t,n,r){if(!e.exports.existsSync(t))return e.exports.writeFileSync(t,n,r);var o=NSFileHandle.fileHandleForWritingAtPath(t);o.seekToEndOfFile();var a=l(r,"utf8"),s=i.from(n,"NSData"===a||"buffer"===a?void 0:a).toNSData();o.writeData(s)},e.exports.chmod=c("chmod"),e.exports.chmodSync=function(e,t){var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().setAttributes_ofItemAtPath_error({NSFilePosixPermissions:t},e,n),null!==n.value())throw s(e,void 0,n.value())},e.exports.chown=c("chown"),e.exports.chownSync=c("chownSync"),e.exports.close=c("close"),e.exports.closeSync=c("closeSync"),e.exports.copyFile=c("copyFile"),e.exports.copyFileSync=function(e,t,n){var i=MOPointer.alloc().init();if(NSFileManager.defaultManager().copyItemAtPath_toPath_error(e,t,i),null!==i.value())throw s(e,!1,i.value())},e.exports.createReadStream=c("createReadStream"),e.exports.createWriteStream=c("createWriteStream"),e.exports.exists=c("exists"),e.exports.existsSync=function(e){var t=NSFileManager.defaultManager();return Boolean(Number(t.fileExistsAtPath(e)))},e.exports.fchmod=c("fchmod"),e.exports.fchmodSync=c("fchmodSync"),e.exports.fchown=c("fchown"),e.exports.fchownSync=c("fchownSync"),e.exports.fdatasync=c("fdatasync"),e.exports.fdatasyncSync=c("fdatasyncSync"),e.exports.fstat=c("fstat"),e.exports.fstatSync=c("fstatSync"),e.exports.fsync=c("fsync"),e.exports.fsyncSync=c("fsyncSync"),e.exports.ftruncate=c("ftruncate"),e.exports.ftruncateSync=c("ftruncateSync"),e.exports.futimes=c("futimes"),e.exports.futimesSync=c("futimesSync"),e.exports.lchmod=c("lchmod"),e.exports.lchmodSync=c("lchmodSync"),e.exports.lchown=c("lchown"),e.exports.lchownSync=c("lchownSync"),e.exports.link=c("link"),e.exports.linkSync=function(e,t){var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().linkItemAtPath_toPath_error(e,t,n),null!==n.value())throw s(e,void 0,n.value())},e.exports.lstat=c("lstat"),e.exports.lstatSync=function(e){var t=MOPointer.alloc().init(),n=NSFileManager.defaultManager().attributesOfItemAtPath_error(e,t);if(null!==t.value())throw s(e,void 0,t.value());return o(n)},e.exports.mkdir=c("mkdir"),e.exports.mkdirSync=function(e,t){var n=511,i=!1;t&&t.mode&&(n=t.mode),t&&t.recursive&&(i=t.recursive),"number"==typeof t&&(n=t);var r=MOPointer.alloc().init();if(NSFileManager.defaultManager().createDirectoryAtPath_withIntermediateDirectories_attributes_error(e,i,{NSFilePosixPermissions:n},r),null!==r.value())throw new Error(r.value())},e.exports.mkdtemp=c("mkdtemp"),e.exports.mkdtempSync=function(t){var n=t+function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<6;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}();return e.exports.mkdirSync(n),n},e.exports.open=c("open"),e.exports.openSync=c("openSync"),e.exports.read=c("read"),e.exports.readdir=c("readdir"),e.exports.readdirSync=function(e,t){for(var n=l(t,"utf8"),r=NSFileManager.defaultManager().subpathsAtPath(e),o=[],a=0;a<r.length;a++){var s=r[a];o.push("buffer"===n?i.from(s):String(s))}return o},e.exports.readFile=c("readFile"),e.exports.readFileSync=function(e,t){var n=l(t,"buffer"),r=NSFileManager.defaultManager().contentsAtPath(e);if(!r)throw s(e,!1);var o=i.from(r);return"buffer"===n?o:"NSData"===n?o.toNSData():o.toString(n)},e.exports.readlink=c("readlink"),e.exports.readlinkSync=function(e){var t=MOPointer.alloc().init(),n=NSFileManager.defaultManager().destinationOfSymbolicLinkAtPath_error(e,t);if(null!==t.value())throw s(e,void 0,t.value());return String(n)},e.exports.readSync=c("readSync"),e.exports.realpath=c("realpath"),e.exports.realpath.native=c("realpath.native"),e.exports.realpathSync=function(e){return String(NSString.stringWithString(e).stringByResolvingSymlinksInPath())},e.exports.realpathSync.native=c("realpathSync.native"),e.exports.rename=c("rename"),e.exports.renameSync=function(e,t){var n=MOPointer.alloc().init(),i=NSFileManager.defaultManager();i.moveItemAtPath_toPath_error(e,t,n);var r=n.value();if(null!==r){if("NSCocoaErrorDomain"!==String(r.domain())||516!==Number(r.code()))throw s(e,void 0,r);var o=MOPointer.alloc().init();if(i.replaceItemAtURL_withItemAtURL_backupItemName_options_resultingItemURL_error(NSURL.fileURLWithPath(t),NSURL.fileURLWithPath(e),null,NSFileManagerItemReplacementUsingNewMetadataOnly,null,o),null!==o.value())throw s(e,void 0,o.value())}},e.exports.rmdir=c("rmdir"),e.exports.rmdirSync=function(t){var n=MOPointer.alloc().init(),i=NSFileManager.defaultManager();if(!e.exports.lstatSync(t).isDirectory())throw a("ENOTDIR",{path:t,syscall:"rmdir"});if(i.removeItemAtPath_error(t,n),null!==n.value())throw s(t,!0,n.value(),"rmdir")},e.exports.stat=c("stat"),e.exports.statSync=function(t){return e.exports.lstatSync(e.exports.realpathSync(t))},e.exports.symlink=c("symlink"),e.exports.symlinkSync=function(e,t){var n=MOPointer.alloc().init();NSFileManager.defaultManager().createSymbolicLinkAtPath_withDestinationPath_error(t,e,n);if(null!==n.value())throw new Error(n.value())},e.exports.truncate=c("truncate"),e.exports.truncateSync=function(e,t){var n=NSFileHandle.fileHandleForUpdatingAtPath(sFilePath);n.truncateFileAtOffset(t||0),n.closeFile()},e.exports.unlink=c("unlink"),e.exports.unlinkSync=function(t){var n=MOPointer.alloc().init(),i=NSFileManager.defaultManager();if(e.exports.lstatSync(t).isDirectory())throw a("EPERM",{path:t,syscall:"unlink"});i.removeItemAtPath_error(t,n);if(null!==n.value())throw s(t,!1,n.value())},e.exports.unwatchFile=c("unwatchFile"),e.exports.utimes=c("utimes"),e.exports.utimesSync=function(e,t,n){var i=MOPointer.alloc().init();NSFileManager.defaultManager().setAttributes_ofItemAtPath_error({NSFileModificationDate:t},e,i);if(null!==i.value())throw s(e,void 0,i.value())},e.exports.watch=c("watch"),e.exports.watchFile=c("watchFile"),e.exports.write=c("write"),e.exports.writeFile=c("writeFile"),e.exports.writeFileSync=function(e,t,n){var r=l(n,"utf8");i.from(t,"NSData"===r||"buffer"===r?void 0:r).toNSData().writeToFile_atomically(e,!0)},e.exports.writeSync=c("writeSync")},function(e,t){e.exports.parseStat=function(e){return{dev:String(e.NSFileDeviceIdentifier),mode:e.NSFileType|e.NSFilePosixPermissions,nlink:Number(e.NSFileReferenceCount),uid:String(e.NSFileOwnerAccountID),gid:String(e.NSFileGroupOwnerAccountID),size:Number(e.NSFileSize),atimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),mtimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),ctimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),birthtimeMs:1e3*Number(e.NSFileCreationDate.timeIntervalSince1970()),atime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),mtime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),ctime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),birthtime:new Date(1e3*Number(e.NSFileCreationDate.timeIntervalSince1970())+.5),isBlockDevice:function(){return e.NSFileType===NSFileTypeBlockSpecial},isCharacterDevice:function(){return e.NSFileType===NSFileTypeCharacterSpecial},isDirectory:function(){return e.NSFileType===NSFileTypeDirectory},isFIFO:function(){return!1},isFile:function(){return e.NSFileType===NSFileTypeRegular},isSocket:function(){return e.NSFileType===NSFileTypeSocket},isSymbolicLink:function(){return e.NSFileType===NSFileTypeSymbolicLink}}};var n={EPERM:{message:"operation not permitted",errno:-1},ENOENT:{message:"no such file or directory",errno:-2},EACCES:{message:"permission denied",errno:-13},ENOTDIR:{message:"not a directory",errno:-20},EISDIR:{message:"illegal operation on a directory",errno:-21}};function i(e,t){var i=new Error(e+": "+n[e].message+", "+(t.syscall||"")+(t.path?" '"+t.path+"'":""));return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.code=e,i.errno=n[e].errno,i}e.exports.fsError=i,e.exports.fsErrorForPath=function(t,n,r,o){var a=NSFileManager.defaultManager();if(!a.fileExistsAtPath(t))return i("ENOENT",{path:t,syscall:o||"open"});if(!a.isReadableFileAtPath(t))return i("EACCES",{path:t,syscall:o||"open"});if(void 0!==n){var s=e.exports.lstatSync(t).isDirectory();if(s&&!n)return i("EISDIR",{path:t,syscall:o||"read"});if(!s&&n)return i("ENOTDIR",{path:t,syscall:o||"read"})}return new Error(r||"Unknown error while manipulating "+t)},e.exports.encodingFromOptions=function(e,t){return e&&e.encoding?String(e.encoding):e?String(e):t},e.exports.NOT_IMPLEMENTED=function(e){return function(){throw new Error("fs."+e+" is not implemented yet. If you feel like implementing it, any contribution will be gladly accepted on https://github.com/skpm/fs")}}},function(e,t,n){e.exports.exec=n(39),e.exports.execFile=n(14),e.exports.spawn=n(15),e.exports.spawnSync=n(8),e.exports.execFileSync=n(19),e.exports.execSync=n(40)},function(e,t,n){var i=n(14);e.exports=function(e,t,n){var r=function(e,t,n){return"function"==typeof t&&(n=t,t=void 0),(t=Object.assign({},t)).shell="string"!=typeof t.shell||t.shell,{file:e,options:t,callback:n}}(e,t,n);return i(r.file,r.options,r.callback)}},function(e,t,n){var i=n(19);e.exports=function(e,t){var n=function(e,t){return(t=Object.assign({},t)).shell="string"!=typeof t.shell||t.shell,{file:e,options:t}}(e,t);return i(n.file,n.options)}},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/fedcb36887af924ae92824d43f90ed04.html"},function(e,t,n){"use strict";n.r(t);var i=n(23),r=n.n(i);var o={Top2BottomByLayerList:1,Bottom2TopByLayerList:2,Left2RightByArtboard:3,Right2LeftByArtboard:4,Top2BottomByArtboard:5},a=(function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}({Top2BottomByLayerList:1},"Top2BottomByLayerList",2),n(35)),s=n(0).getSelectedDocument();function l(e,t){var n=function(e){return"Top to Bottom"===e?o.Top2BottomByLayerList:"Bottom to Top"===e?o.Bottom2TopByLayerList:"Left to Right"===e?o.Left2RightByArtboard:"Right to Left"===e?o.Right2LeftByArtboard:"Top to Bottom 1"===e?o.Top2BottomByArtboard:void 0}(t),i=[];return e.layers.slice().forEach(function(e){"Artboard"===e.type&&i.push(e)}),n===o.Top2BottomByLayerList?i.reverse():n===o.Bottom2TopByLayerList?i:n===o.Left2RightByArtboard?i.sort(function(e,t){return e.frame.y>t.frame.y+t.frame.height/2?e.frame.y-t.frame.y+t.frame.height/2:e.frame.x-t.frame.x}):n===o.Right2LeftByArtboard?i.sort(function(e,t){return e.frame.y>t.frame.y+t.frame.height/2?e.frame.y-t.frame.y+t.frame.height/2:t.frame.x-e.frame.x}):n===o.Top2BottomByArtboard?i.sort(function(e,t){return e.frame.x>t.frame.x+t.frame.width/2?e.frame.x-t.frame.x+t.frame.width/2:e.frame.y-t.frame.y}):void 0}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(l){r=!0,o=l}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var u,d,f,p,h=n(2),m=n(0).Artboard,g=n(6),S=n(0).Group,v=n(0).Text,y=n(0).ShapePath,w=n(13),b=n(0).getSelectedDocument(),x=null,N=null,_=7e3,F=4949,E=700,T=500,C=200,M=(_-2*C-2*E)/3,R=[],k=0,A=new Map,D="";function I(e,t){var n=new v({parent:e,text:"0",name:"pageNumber",style:{borders:[],fontFamily:"PingFang SC",fontSize:88,fontWeight:4,textColor:"#FFFFFF",alignment:"right",verticalAlignment:"center"},frame:{x:6747,y:88,width:53,height:123}});n.text=t,n.name="pageNumber",g.setLayerSettingForKey(n,"textType","pageNumber")}function B(e,t,n,i,r,o){var a,s,l,c,u,d;1===i?(s=0,c=64,u=6,d="#333333",a=l=90):2===i?(s=80,c=56,u=4,d="#333333",a=l=78):(s=160,c=48,u=4,d="#666666",a=l=67);var f,p=new v({text:r.trim(),name:"serialAndContent",style:{borders:[],fontFamily:"PingFang SC",fontSize:c,fontWeight:u,textColor:d,alignment:"left",verticalAlignment:"center"},frame:{x:s,y:(a-l)/2,height:a}}),h=new y({name:"separator",shapeType:y.ShapeType.Custom,style:{borders:[{thickness:3}],borderOptions:{dashPattern:[20,5,20,5]}},frame:{x:p.frame.x+p.frame.width+100,y:0,width:M-(p.frame.x+p.frame.width+100)-100,height:a},points:[{point:{x:0,y:.5}},{point:{x:1,y:.5}}]});1===i?f=56:2===i?f=56:3===i&&(f=56);var m=new v({text:o.toString(),name:"pageNumber",style:{borders:[],fontFamily:"PingFang SC",fontSize:f,fontWeight:4,textColor:"#333333",alignment:"right",verticalAlignment:"center"},frame:{x:M-100,y:(a-78)/2,width:100,height:a}}),g=new y({name:"placeholder",shapeType:y.ShapeType.Custom,frame:{x:0,y:0,width:1,height:a}}),w=new S({parent:e,name:r,frame:{x:t,y:n,width:M,height:a}});return w.adjustToFit(),w.layers=[g,p,h,m],w}function O(e,t){var n=!1;if(0===e.length)"1."!==t&&(n=!0);else if(e.endsWith(".")){var i=e;"1"===e.split(".")[0]&&"3"===t.split(".")[0]&&(i="2."),t!==i+"1"&&t!==parseInt(i)+1+"."&&(n=!0)}else{var r,o=e.split("."),a=o,s=o.length;s>2&&(r=a[a.length-2],a.splice(a.length-1,2));var l=o[0],c=o[o.length-1];o.splice(o.length-1,1),2===s?t!==e+".1"&&t!==l+"."+(parseInt(c)+1)&&t!==parseInt(l)+1+"."&&(n=!0):t!==e+".1"&&t!==o.join(".")+(parseInt(c)+1)&&t!==a.join(".")+(parseInt(r)+1)&&(n=!0)}return!n}function P(e){b.selectedLayers.forEach(function(e){e.selected=!1}),e.parent.selected=!0,e.selected=!0,b.centerOnLayer(e)}function L(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],o=void 0;if(0===i)o=1===e.length?"2. 目录":"2. 目录01";else{var a=void 0;a=i<10?"0"+i:i,o="2."+i.toString()+" 目录"+a}r.layers[0].overrides[0].value=o,n.push(o)}var s=new Map,l=0,c=!1;return t.forEach(function(e,t){if(!c&&parseInt(t.split(".")[0])>2){c=!0;for(var i=0;i<n.length;i++){var r=n[i];s.set(r,l+i+1)}}l+=e,s.set(t,e)}),s.forEach(function(t,n){parseInt(n.split(".")[0])>2&&s.set(n,t+e.length)}),s}function W(e,t){var n;e.layers.forEach(function(e){"TOC"===g.layerSettingForKey(e,"layerType")&&e.remove()});var i=[],r=0,o=0,a=T,s=!0,l=!0,u=!1,d=void 0;try{for(var h,S=t[Symbol.iterator]();!(l=(h=S.next()).done);l=!0){var v=c(h.value,2),y=v[0],w=v[1];if(s){n=new m({parent:e,name:"Contents "+(r+1).toString(),frame:{x:0+(_+50)*r,y:0,width:_,height:F},background:{enabled:!0,color:"#FBFBFB"}}),g.setLayerSettingForKey(n,"layerType","TOC"),i.push(n);var b=f.createNewInstance(),x=p[0].createNewInstance();x.frame.y=F-x.frame.height,b.parent=n,x.parent=n,r+=1}var N=void 0,R=y.split(" ")[0];N=R.endsWith(".")?1:R.split(".").length,s||(a+=1===N?100:46),N;var k=B(n,C+M*o+E*o,a,N,y,w);k.frame.y>4e3?(o+=1,a=T):a+=k.frame.height,o>2?(s=!0,o=0):s=!1}}catch(A){u=!0,d=A}finally{try{l||null==S.return||S.return()}finally{if(u)throw d}}return i}function U(e){g.layerSettingForKey(e,"layerType");for(var t=e.layers,n=0;n<t.length;n++){var i=t[n];if("SymbolInstance"===i.type&&"Title"===i.master.name){var r=i.overrides[0];if(r){f=i.master;var o=r.value;if(o=(o=o.trim()).replace(/ {1,}/," "),r.value=o,r=i.overrides[0],A.has(r.value))return console.log("same heading:",r.value),P(e),d=r,N.executeJavaScript("showCreateTocHint('标题有重复', ".concat(JSON.stringify(r.value),")")),!1;var a=new RegExp(/(^[1-9][0-9]{0,}\. )|(^[1-9][0-9]{0,}((\.[1-9][0-9]{0,}){1,5}) )/);if(r.value.length&&!a.test(r.value))return console.log("invalid format heading:",r.value),P(e),d=r,N.executeJavaScript("showCreateTocHint('无效的标题，正确格式示例:【1. XXX】 或者 【1.1 XXX】', ".concat(JSON.stringify(r.value),")")),!1;var s=r.value.split(" ")[0];if(s.endsWith("1")&&!s.startsWith(D)){var l=g.layerSettingForKey(e,"parentHeading");if(!l)return console.log("should add parent heading:",e.name),P(e),u=e,N.executeJavaScript("showCreateTocHint('需要添加当前标题的父标题，当前标题为:' + ".concat(JSON.stringify(r.value),")")),!1;if(l.startsWith(s.slice(0,-2)))D=l.split(" ")[0],A.set(l,k+1);else{var c=l.split(" ")[0];if(!O(D,c)||s!==c+".1")return console.log("invalid sort parent heading:",e.name),P(e),u=e,N.executeJavaScript("showCreateTocHint('父级标题序号不正确，请更正。上一标题序号为:' + ".concat(JSON.stringify(D),", ").concat(JSON.stringify(l),")")),!1}}if(!O(D,s))return console.log("invalid sort heading:",r.value),P(e),d=r,N.executeJavaScript("showCreateTocHint('当前标题序号不正确，请更正。上一标题序号为:' + ".concat(JSON.stringify(D),", ").concat(JSON.stringify(r.value),")")),!1;A.set(r.value,k+1),D=s;break}}}if(k<R.length-1)++k,setTimeout(U.bind(null,R[k]),5);else{if(0===A.size)return console.log("no headings"),w.alert("Error","找不到目录页，请检查标题设置是否正确"),void N.executeJavaScript("showCreateTocCreate()");var p=W(b.selectedPage,A),m=L(p,A),S=W(b.selectedPage,m);m=L(S,m),p.length!==S.length&&(console.log("new content artboards'size greater than the old one."),m=L(S=W(b.selectedPage,m),m)),setTimeout(function(e){h.find('Text, [name="{page}"]').forEach(function(e){e.remove()}),h.find("Text",b.selectedPage).forEach(function(e){"pageNumber"===g.layerSettingForKey(e,"textType")&&e.remove()}),R.forEach(function(t){for(var n=h.find("SymbolInstance",t),i=0;i<n.length;i++){var r=n[i];if("Title"===r.master.name){var o=r.overrides[0];if(o){var a=A.get(o.value);a>2&&(a+=e.length),I(t,a.toString());break}}}});var t=3;e.forEach(function(e){I(e,t.toString()),++t}),e.length>0&&(b.selectedLayers.forEach(function(e){e.selected=!1}),e[0].selected=!0,b.centerOnLayer(e[0])),x.close(),h.UI.message("Successfully! 🙌")}.bind(null,S),5)}}function j(e,t,n){var i;if(arguments.length>3&&void 0!==arguments[3]&&arguments[3])setTimeout(U.bind(null,R[k]),5);else{if(x=n,N=t,!((i=b.selectedPage)?i.isSymbolsPage()?(w.alert("Error","请选中“文档页”，当前选中的是“组件页”"),0):"TOC"!==g.layerSettingForKey(i,"layerType")||(w.alert("Error","请选中“文档页”，当前选中的是“目录页”"),0):(w.alert("Error","请选中“文档页”"),0)))return void N.executeJavaScript("showCreateTocCreate()");if(!(p=h.find('SymbolMaster, [name="页尾"]')).length&&(console.log("can not found the banner"),w.alert("Error","请添加生成目录所需要组件:页尾"),N.executeJavaScript("showCreateTocCreate()"),1))return void N.executeJavaScript("showCreateTocCreate()");if(0===(R=l(b.selectedPage,e)).length)return console.log("no artboards"),w.alert("Error","当前文档为空，无需要生成目录"),void N.executeJavaScript("showCreateTocCreate()");for(var r=0;r<R.length;r++){if("TOC"===g.layerSettingForKey(R[r],"layerType")){R.splice(r,1);break}}A.clear(),k=0,D="",setTimeout(U.bind(null,R[0]),5)}}n(2);var z=n(6),J=n(0).getSelectedDocument();function V(e,t,n){n,t;var i=J.selectedLayers.layers;if(1===i.length&&"Artboard"===i[0].type){var r=i[0];z.setLayerSettingForKey(r,"parentHeading",e)}}var H=n(2),K=n(6),G=n(0).Text,q=(n(13),n(0).getSelectedDocument()),X=null,Z=[],Y=0,$="";function Q(){H.find("Text",q.selectedPage).forEach(function(e){"pageNumber"===K.layerSettingForKey(e,"textType")&&e.remove()}),(Z=l(q.selectedPage,$)).length>0&&(Y=0,setTimeout(function e(t){for(var n=H.find("SymbolInstance",t),i=0;i<n.length;i++){var r=n[i];if("Title"===r.master.name&&r.overrides[0]){var o=new G({parent:t,text:"0",name:"pageNumber",style:{borders:[],fontFamily:"PingFang SC",fontSize:88,fontWeight:4,textColor:"#FFFFFF",alignment:"right",verticalAlignment:"center"},frame:{x:6747,y:88,width:53,height:123}});o.text=(Y+1).toString(),K.setLayerSettingForKey(o,"textType","pageNumber");break}}Y===Z.length-1?(X.close(),H.UI.message("Successfully! 🙌")):(++Y,setTimeout(e.bind(null,Z[Y]),20))}.bind(null,Z[0]),20))}function ee(e,t,n){X=n,t,$=e,setTimeout(function(){H.find('Text, [name="{page}"]').forEach(function(e){e.remove()}),setTimeout(Q.bind(null),20)}.bind(null),20)}function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ne=n(2),ie=n(36),re=n(38).exec,oe=n(0).getSelectedDocument(),ae="",se=null,le=null,ce=[],ue=0,de=0,fe=0,pe=[],he={formats:"json",output:!1},me=!1,ge=["","artboard","text","bitmap","group","shapeGroup","symbolInstance","rectangle","oval","shapePath","triangle","star","polygon","slice","MSImmutableHotspotLayer"];function Se(e){var t={scales:"1",formats:"png",output:ae+"/images","use-id-for-name":!0,overwriting:!0};ne.export(e,t),ie.renameSync(ae+"/images/"+e.id+".png",ae+"/images/"+e.id.toLowerCase()+".png")}function ve(){me=!0}function ye(){se.setClosable(!0),se.close()}function we(e){if(me)ye();else{var t=ne.export(e,he);if(JSON.parse(JSON.stringify(t),function(e,t){return ge.includes(t._class)&&(de+=1),t}),(ue+=1)<ce.length)setTimeout(we.bind(null,ce[ue]),5);else{ue=0,le.executeJavaScript("exportProgress(0)"),le.executeJavaScript("exportMessage('Exporting ".concat(ce[0].name,"')"));var n=ne.export(ce[0],he);setTimeout(function e(t){if(me)return void ye();var n=!1;var i=!1;var r=JSON.parse(JSON.stringify(t),function(e,t){return n?t:""===e?(n=!0,i=!0,function(e){return{objectID:e.do_objectID,type:"page",name:e.name,rect:{x:e.frame.x,y:e.frame.y,width:e.frame.width,height:e.frame.height},rotation:e.rotation,layers:e.layers}}(t)):isNaN(e)?t:"artboard"===t._class?(n=!0,function(e){return{objectID:e.do_objectID,type:e._class,name:e.name,rect:{x:e.frame.x,y:e.frame.y,width:e.frame.width,height:e.frame.height},rotation:e.rotation,layers:e.layers}}(t)):"text"===t._class?(n=!0,function(e){return{objectID:e.do_objectID,type:e._class,name:e.name,rect:{x:e.frame.x,y:e.frame.y,width:e.frame.width,height:e.frame.height},rotation:e.rotation,content:e.attributedString.string,fontFamily:e.style.textStyle.encodedAttributes.MSAttributedStringFontAttribute.attributes.name,fontSize:e.style.textStyle.encodedAttributes.MSAttributedStringFontAttribute.attributes.size,fontColor:{r:e.style.textStyle.encodedAttributes.MSAttributedStringColorAttribute.red,g:e.style.textStyle.encodedAttributes.MSAttributedStringColorAttribute.green,b:e.style.textStyle.encodedAttributes.MSAttributedStringColorAttribute.blue,a:e.style.textStyle.encodedAttributes.MSAttributedStringColorAttribute.alpha}}}(t)):"bitmap"===t._class?(n=!0,Se(oe.getLayerWithID(t.do_objectID)),function(e){return{objectID:e.do_objectID,type:e._class,name:e.name,rect:{x:e.frame.x,y:e.frame.y,width:e.frame.width,height:e.frame.height},rotation:e.rotation,export:"images/"+e.do_objectID.toLowerCase()+".png"}}(t)):"group"===t._class||"shapeGroup"===t._class?(n=!0,function(e){return{objectID:e.do_objectID,type:e._class,name:e.name,rect:{x:e.frame.x,y:e.frame.y,width:e.frame.width,height:e.frame.height},rotation:e.rotation,layers:e.layers}}(t)):"symbolInstance"===t._class?(n=!0,Se(oe.getLayerWithID(t.do_objectID)),function(e){var t=e.overrideValues,n=[];return t.forEach(function(e){var t,i=JSON.parse(JSON.stringify(e),function(e,n){if("_class"!==e){if("overrideName"===e){var i=n.split("_"),r=i.pop();return t=r,i.join()}return"value"===e&&"object"===te(n)?n._ref:n}});n.push({type:t,name:i.overrideName,value:i.value})}),{objectID:e.do_objectID,symbolID:e.symbolID,type:e._class,name:e.name,rect:{x:e.frame.x,y:e.frame.y,width:e.frame.width,height:e.frame.height},rotation:e.rotation,export:"images/"+e.do_objectID.toLowerCase()+".png",overrideValues:n}}(t)):"rectangle"===t._class||"oval"===t._class||"shapePath"===t._class||"triangle"===t._class||"star"===t._class||"polygon"===t._class||"slice"===t._class||"MSImmutableHotspotLayer"===t._class?(n=!0,Se(oe.getLayerWithID(t.do_objectID)),function(e){return{objectID:e.do_objectID,type:e._class,name:e.name,rect:{x:e.frame.x,y:e.frame.y,width:e.frame.width,height:e.frame.height},rotation:e.rotation,export:"images/"+e.do_objectID.toLowerCase()+".png"}}(t)):t});if(i)if(pe.push(r),(ue+=1)<ce.length){le.executeJavaScript("exportMessage('Exporting ".concat(ce[ue].name,"')"));var o=ne.export(ce[ue],he);e(o)}else{le.executeJavaScript("exportMessage('Creating metadata file)"),ie.writeFileSync(ae+"/metadata.json",JSON.stringify({pages:pe}));var a=ae+"/unzip";ie.existsSync(a)&&ie.rmdirSync(a,{recursive:!0}),ne.UI.message("Export Successfully! 🙌"),ye()}else fe+=1,le.executeJavaScript("exportProgress(".concat(JSON.stringify(100*fe/de),")")),setTimeout(e.bind(null,r),5)}.bind(null,n),5)}}}var be={name:"dark",text:"#E6E4EB",bg:"#2D2D2D",previewColor:"#F3F2F5",input:{background:"#373737",color:"#F3F2F5",border:"#454545",borderActive:"#1384FF"},button:{color:"#F3F2F5",bgColor:"rgba(255,255,255,0.25)",border:"#636363",bgActive:"rgba(255,255,255,0.10)"},secondaryButton:{borderColor:"#636363",textColor:"#F3F2F5"},CTAButton:{bgColor:"#1384FF",textColor:"#fff",bgActive:"#0F72DB"},radio:{selectedColor:"#1384FF",border:"#1384FF"}},xe={name:"light",text:"#747474",bg:"#F7F7F7",previewColor:"#242424",input:{background:"#FBFBFB",color:"#505050",border:"#E4E4E4",borderActive:"#1384FF"},button:{color:"#505050",bgColor:"#FBFBFB",border:"#E4E4E4",bgActive:"#F3F2F5"},secondaryButton:{borderColor:"#B2AEBD",textColor:"#817B8F"},CTAButton:{bgColor:"#1384FF",textColor:"#fff",bgActive:"#0F72DB"},radio:{selectedColor:"#969696",border:"#969696"}},Ne=n(24),_e=n.n(Ne),Fe=!1,Ee=function(e){var t="undefined"!=typeof MSTheme&&MSTheme.sharedTheme().isDark()?"dark":"light",i=function(e){return"dark"===e?be:xe}(t),o={identifier:e.identifier,title:e.title,width:e.width,height:e.height,minimizable:!1,maximizable:!1,resizable:!1,fullscreenable:!1,backgroundColor:i.bg,alwaysOnTop:!0,show:!1},l="",c=new r.a(o),f=c.webContents;c.once("ready-to-show",function(){c.show()}),c.on("closed",function(e){c=null}),f.on("cancel",function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?f.executeJavaScript("showExportAlert()"):Fe?ve():(c.setClosable(!0),c.close())}),c.loadURL(n(41)),f.on("createTableOfContent",function(){j(l,f,c)}),f.on("createContinue",function(e){!function(e){d&&(d.value=e,d=void 0),u&&(g.setLayerSettingForKey(u,"parentHeading",e),u=void 0)}(e),j(l,f,c,!0)}),f.on("resetParentHeadingApply",function(e){V(e,f,c)}),f.on("resetParentHeadingOK",function(e){V(e,f,c),c.close()}),f.on("addPageNumber",function(){ee(l,f,c)}),f.on("exportMetadata",function(e){Fe=!0,c.setClosable(!1),function(e,t,n){ae=e,se=n,le=t,ie.existsSync(ae)&&(le.executeJavaScript("exportMessage('Clearing output')"),ie.rmdirSync(ae,{recursive:!0})),ie.existsSync(ae)||(le.executeJavaScript("exportMessage('Creating output directory')"),ie.mkdirSync(ae));var i='/usr/bin/unzip -o "'+oe.path.replace(/%20/g," ")+'" -d "'+ae+'/unzip"';le.executeJavaScript("exportMessage('Unzip sketch file...')"),re(i,function(){oe.pages.forEach(function(e){"Symbols"!==e.name&&ce.push(e)}),ce.length>0&&(le.executeJavaScript("exportMessage('Counting target layers')"),we(ce[0]))})}(e+"/"+s.path.replace(/^.*[\\\/]/,"").replace(".sketch","").replace(/%20/g," ")+"_output",f,c)}),f.on("openFolder",function(){var e=_e.a.showOpenDialogSync({properties:["openDirectory"]});if(e&&e.length){var t=e[0];f.executeJavaScript("setExportDir(".concat(JSON.stringify(t),")"))}}),f.on("artboardSort",function(e){l=e}),f.on("artboardInnerLayersSort",function(e){artboardInnerLayersSort=e}),f.on("nativeLog",function(e){console.log("nativeLog: ",e)});var p=function(){f.executeJavaScript("setTheme(".concat(JSON.stringify(t),")")),f.executeJavaScript("setRedirectTo(".concat(JSON.stringify(e.redirectTo),")")),"/export_metadata"===e.redirectTo&&(f.executeJavaScript("setExportDir(".concat(JSON.stringify(a.homedir()+"/Desktop"),")")),setTimeout(function(){var e,t;f.executeJavaScript("setExportNodes(".concat(JSON.stringify((e=oe.pages,t=[],e.forEach(function(e){var n=[],i=ne.export(e,he);JSON.parse(JSON.stringify(i),function(e,t){return"artboard"===t._class&&n.push({value:t.do_objectID,label:t.name}),t}),t.push({value:e.id,label:e.name,children:n})}),console.log(t),t)),")"))},1e3))};f.on("did-start-loading",function(){return p()}),f.on("getData",function(){return p()})};t.default=function(){Ee({identifier:"addPageNumber.ui",title:"添加页码",redirectTo:"/add_pageNumber",width:600,height:310})}}]);if("default"===key&&"function"==typeof exports)exports(context);else{if("function"!=typeof exports[key])throw new Error('Missing export named "'+key+'". Your command should contain something like `export function " + key +"() {}`.');exports[key](context)}}globalThis.onRun=__skpm_run.bind(this,"default");