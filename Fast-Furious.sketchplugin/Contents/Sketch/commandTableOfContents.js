var globalThis=this;function __skpm_run(e,t){globalThis.context=t;var r=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t){e.exports=require("sketch/dom")},function(e,t){e.exports=require("sketch")},function(e,t,r){"use strict";r.r(t);r(1);var n="Table of Contents",a={Top2BottomByLayerList:1,Bottom2TopByLayerList:2,Left2RightByArtboard:3,Right2LeftByArtboard:4,Top2BottomByArtboard:5},o={Top2BottomByLayerList:1,Bottom2TopByLayerList:2};function i(e,t){if(!function(e){return void 0!==e.layers&&0!==e.layers.length}(e))return t;var r=e.layers.slice().reverse(),n=!0,a=!1,o=void 0;try{for(var f,l=r[Symbol.iterator]();!(n=(f=l.next()).done);n=!0){var u=f.value;t.push(u),i(u,t)}}catch(y){a=!0,o=y}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.Left2RightByArtboard,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.Bottom2TopByLayerList,n=[],f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.Left2RightByArtboard,r=e.layers.slice();return t===a.Top2BottomByLayerList?r.reverse():t===a.Bottom2TopByLayerList?r:t===a.Left2RightByArtboard?r.sort(function(e,t){return e.frame.y<t.frame.y?-1:e.frame.y>t.frame.y?1:e.frame.x<t.frame.x?-1:e.frame.x>t.frame.x?1:0}):t===a.Right2LeftByArtboard?r.sort(function(e,t){return e.frame.y<t.frame.y?-1:e.frame.y>t.frame.y?1:e.frame.x>t.frame.x?-1:e.frame.x<t.frame.x?1:0}):t===a.Top2BottomByArtboard?r.sort(function(e,t){return e.frame.x<t.frame.x?-1:e.frame.x>t.frame.x?1:e.frame.y<t.frame.y?-1:e.frame.y>t.frame.y?1:0}):void 0}(e,t),l=!0,u=!1,y=void 0;try{for(var m,s=f[Symbol.iterator]();!(l=(m=s.next()).done);l=!0){var c=m.value;n.push(c);var h=[];i(c,h),r===o.Top2BottomByLayerList?n=n.concat(h):r===o.Bottom2TopByLayerList&&(n=n.concat(h.reverse()))}}catch(d){u=!0,y=d}finally{try{l||null==s.return||s.return()}finally{if(u)throw y}}return n}function l(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",r=e.name,n="",a=0;a<r.length&&r.charAt(a)===t;++a)n+="#";return n.length}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,f=e[Symbol.iterator]();!(n=(i=f.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(l){a=!0,o=l}finally{try{n||null==f.return||f.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var y=r(1),m=r(0).Page,s=r(0).Artboard,c=r(0).Group,h=r(0).Text,d=r(0).getSelectedDocument();function v(e,t,r,n){var a=function(e){return e.name.slice(l(e))}(n),o=l(n),i=new h({text:"",name:"Left Space"});i.frame={x:0,y:0,width:50,heigth:100};var f=new h({text:"",name:"Right Space"});f.frame={x:950,y:0,width:50,heigth:100};var u=new c({parent:e,name:t});u.adjustToFit();var y,m=new h({text:t+" "+a,name:"Serial and Content",style:{borders:[],fontFamily:"å¹³æ–¹-ç®€",fontSize:(y=o,1===y?60:2===y?50:3===y?40:4===y?30:5===y?30:6===y?30:void 0),textColor:"#000000",alignment:"left",verticalAlignment:"center"}}),s=new h({text:"......................",name:"Combinator",style:{borders:[],fontFamily:"å¹³æ–¹-ç®€",fontSize:40,textColor:"#000000",alignment:"left",verticalAlignment:"center"}}),d=new h({text:r.toString(),name:"Page Number",style:{borders:[],fontFamily:"å¹³æ–¹-ç®€",fontSize:40,textColor:"#000000",alignment:"right",verticalAlignment:"center"}});u.frame={x:0,width:1e3,height:100},m.frame={x:50*o,y:(u.frame.height-m.frame.height)/2};for(var v="",g=800-m.frame.x-m.frame.width,p=0;p<g/11&&(v+=".",s.text=v,!(s.frame.width>=g));++p);return s.name="Combinator",s.fixedWidth=!0,s.frame={x:m.frame.x+m.frame.width+50,y:(u.frame.height-s.frame.height)/2,width:g},s.style.alignment="right",d.fixedWidth=!0,d.frame={x:850,y:(u.frame.height-d.frame.height)/2,width:100},u.layers=[i,m,s,d,f],u}t.default=function(){var e=d.pages,t=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var h=i.value;if(!h.isSymbolsPage()&&h.name!==n){var g=f(h);t=t.concat(g)}}}catch(I){a=!0,o=I}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}if(0!==t.length){var p=new Map,x=0;if(t.forEach(function(e){(function(e){return"Page"===e.parent.type})(e)&&++x,e.name.startsWith("#")&&p.set(e,x)}),0!==p.size){var b,w=function(){var e=d.pages,t=!0,r=!1,a=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var f=o.value;if(f.name===n)return f}}catch(I){r=!0,a=I}finally{try{t||null==i.return||i.return()}finally{if(r)throw a}}}();void 0===w&&(w=new m({parent:d,name:n}),e.unshift(w)),w.layers=[];var B="",L=-1,S=!0,T=!1,A=void 0;try{for(var _,j=p[Symbol.iterator]();!(S=(_=j.next()).done);S=!0){var P=u(_.value,2),C=P[0],R=P[1];++L%9==0&&(b=new s({parent:w,name:"Contents "+parseInt(L/9+1),frame:{x:50,y:50+L/9*1050,width:1e3,height:1e3}}));var O=l(C),k=B.split(".");if(k.length<O-1)--L,console.log("Invalid heading flag.");else{""===k[0]?k[0]=1:k.length>=O?(k[O-1]=parseInt(k[O-1])+1,k=k.slice(0,O)):k.push(1);var M=v(b,B=k.join("."),R,C);M.frame.y=50+M.frame.height*(L%9)}}}catch(I){T=!0,A=I}finally{try{S||null==j.return||j.return()}finally{if(T)throw A}}y.UI.message("Successfully! ðŸ™Œ")}else console.log("Have no layers as headings.")}else console.log("Have no layers in the document.")}}]);if("default"===e&&"function"==typeof r)r(t);else{if("function"!=typeof r[e])throw new Error('Missing export named "'+e+'". Your command should contain something like `export function " + key +"() {}`.');r[e](t)}}globalThis.onRun=__skpm_run.bind(this,"default");